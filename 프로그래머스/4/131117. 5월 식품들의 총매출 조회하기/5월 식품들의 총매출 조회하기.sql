# SELECT O.PRODUCT_ID, O.AMOUNT, P.PRICE
# FROM FOOD_ORDER O
# JOIN FOOD_PRODUCT P ON O.PRODUCT_ID = P.PRODUCT_ID
# WHERE '2022-05-01' <= O.PRODUCE_DATE AND O.PRODUCE_DATE <= '2022-05-31';

SELECT 
    O.PRODUCT_ID,
    P.PRODUCT_NAME,
    SUM(O.AMOUNT * P.PRICE) AS TOTAL_SALES
FROM 
    FOOD_ORDER O
JOIN 
    FOOD_PRODUCT P ON O.PRODUCT_ID = P.PRODUCT_ID
WHERE '2022-05-01' <= O.PRODUCE_DATE AND O.PRODUCE_DATE <= '2022-05-31'
GROUP BY 
    O.PRODUCT_ID, P.PRODUCT_NAME
ORDER BY 
    TOTAL_SALES DESC, O.PRODUCT_ID ASC;